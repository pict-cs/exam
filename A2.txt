/**
 * Problem Statement: Write a program to implement Huffman Encoding using a greedy strategy.
 */

#include<bits/stdc++.h>
using namespace std;

struct MinHeapNode{
    char data;  
    int freq;  
    MinHeapNode *left, *right; 

    MinHeapNode(char data, int freq){
        left = right = nullptr;
        this->data = data;
        this->freq = freq;
    }
};

struct compare {
    bool operator()(MinHeapNode* left, MinHeapNode* right){
        return (left->freq > right->freq);
    }
};

// Function to print Huffman Codes (preorder)
void printCodes(MinHeapNode* root, string code){
    if(!root)
        return;

    if(!root->left && !root->right)
        cout<< root->data<<" : "<<code<<"\n";

    printCodes(root->left, code+"0");
    printCodes(root->right, code+"1");
}

// Build Huffman Tree
void HuffmanCodes(vector<char> &data, vector<int>& freq){
    int n = data.size();

    priority_queue<MinHeapNode*, vector<MinHeapNode*>, compare> minHeap;

    for(int i =0;i<n;i++){
        minHeap.push(new MinHeapNode(data[i], freq[i]));
    }

    while(minHeap.size() != 1){
        MinHeapNode *left = minHeap.top(); minHeap.pop();
        MinHeapNode *right = minHeap.top(); minHeap.pop();

        MinHeapNode *top = new MinHeapNode('$', left->freq + right->freq);

        top->left = left;
        top->right = right;

        minHeap.push(top);
    }

    cout << "\nGenerated Huffman Codes:\n";
    printCodes(minHeap.top(), "");
}

int main(){
    int choice;

    while(true){
        cout << "\n===== HUFFMAN MENU =====\n";
        cout << "1. Use predefined characters & frequencies\n";
        cout << "2. Enter custom characters & frequencies\n";
        cout << "3. Exit\n";
        cout << "Enter your choice: ";
        cin >> choice;

        if(choice == 1){
            vector<char> data = {'a', 'b', 'c', 'd', 'e', 'f'};
            vector<int> freq = {5, 9, 12, 13, 16, 45};
            HuffmanCodes(data, freq);
        }
        else if(choice == 2){
            int n;
            cout << "How many characters? ";
            cin >> n;

            vector<char> data(n);
            vector<int> freq(n);

            cout << "Enter characters:\n";
            for(int i = 0; i < n; i++)
                cin >> data[i];

            cout << "Enter corresponding frequencies:\n";
            for(int i = 0; i < n; i++)
                cin >> freq[i];

            HuffmanCodes(data, freq);
        }
        else if(choice == 3){
            cout << "Exiting program..." << endl;
            break;
        }
        else {
            cout << "Invalid choice! Try again.\n";
        }
    }

    return 0;
}


/*
===== HUFFMAN MENU =====
1. Use predefined characters & frequencies
2. Enter custom characters & frequencies
3. Exit
Enter your choice: 2
How many characters? 5
Enter characters:
a b c d e
Enter corresponding frequencies:
3 5 6 4 2

Generated Huffman Codes:
d : 00
b : 01
e : 100
a : 101
c : 11

*/